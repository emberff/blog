---
title: åŸºäºå‰ç¼€æ ‘çš„åœ°å€æ ¼å¼åŒ–å·¥å…·ç±»
date: 2025-04-05 15:47:51
tags: [Java]
category: [å­¦ä¹ , Java]
excerpt: åŸºäºå‰ç¼€æ ‘çš„åœ°å€æ ¼å¼åŒ–å·¥å…·ç±»
---
# èµ·å› 
è¿™å‘¨åœ¨åšé¡¹ç›®çš„æ—¶å€™ç¢°åˆ°ä¸€ä¸ªé—®é¢˜: è¦åœ¨é¡¹ç›®çš„æµç¨‹ä¸­æ¥å…¥é˜¿é‡Œäº‘SMSä»¥åŠå¾®ä¿¡å°ç¨‹åºè®¢é˜…æ¶ˆæ¯çš„å‘é€åŠŸèƒ½, è€Œå®ƒä»¬æä¾›çš„å‘é€æ¥æ”¶å‚æ•°é‡Œå¯¹äºä¸åŒç±»å‹çš„å‚æ•°é•¿åº¦æ˜¯æœ‰é™åˆ¶çš„ã€‚`é˜¿é‡Œäº‘SMS` æ¥æ”¶ä½ç½®å‚æ•°æœ€é•¿ä¸º **32ä¸ªå­—ç¬¦** , è€Œå¾®ä¿¡å°ç¨‹åºæ ¹æ®æ¨¡æ¿çš„ä¸åŒ, æä¾›çš„æ¥æ”¶å‚æ•°æœ€é•¿é•¿åº¦ä¹Ÿä¸åŒ: `thing` ç±»å‹æœ€å¤šåªèƒ½æ¥æ”¶**20ä¸ªå­—ç¬¦**...
åœ¨æœ€å¼€å§‹çš„å¼€å‘ç‰ˆæœ¬, å’Œå‰ç«¯çº¦å®šäº†ä¾æ®åœ°åŒºç¼–ç , å°†å€¼é€šè¿‡æ¥å£å‘é€ç»™åç«¯æ—¶åœ¨åŒºå’Œå…·ä½“åœ°å€é—´ä»¥ç©ºæ ¼åˆ†éš”, åç«¯å†åšç®€å•å¤„ç†: é€šè¿‡ç©ºæ ¼åˆ†å‰²å­—ç¬¦ä¸², ç„¶åè·å–ç²¾ç¡®åˆ°åŒºçš„æ–‡æœ¬ã€‚
ç„¶è€Œç°åœ¨å‰ç«¯æ”¹äº†è·å–ç²¾ç¡®åœ°å€çš„æ–¹å¼, ç›´æ¥è°ƒç”¨ `è…¾è®¯åœ°å›¾çš„api` äº†! æ‰€ä»¥åç«¯ä¸å¾—ä¸é¢ä¸´åº”è¯¥å¦‚ä½•åœ¨æœ‰é™çš„é•¿åº¦å†…å°½é‡ç²¾ç¡®çš„é•¿æ–‡æœ¬çš„é—®é¢˜ã€‚
æ°å¥½æœ€è¿‘æˆ‘çœ‹åˆ°å‰ç¼€æ ‘çš„ç›¸å…³å†…å®¹, è„‘å­ä¸€æ‹, è§‰å¾—è¿™ä¸ªæ•°æ®ç»“æ„ç›¸å½“ç¬¦åˆæˆ‘çš„éœ€æ±‚, ç´¢æ€§ç›´æ¥åšäº†ä¸€ä¸ªå·¥å…·ç±»!
# å‰ç¼€æ ‘
å‰ç¼€æ ‘ï¼ˆTrieï¼Œä¹Ÿå«å­—å…¸æ ‘ï¼‰æ˜¯ä¸€ç§ç”¨äºé«˜æ•ˆå­˜å‚¨å’ŒæŸ¥æ‰¾å­—ç¬¦ä¸²é›†åˆçš„æ•°æ®ç»“æ„ï¼Œç‰¹åˆ«é€‚ç”¨äº**å‰ç¼€åŒ¹é…**çš„åœºæ™¯ã€‚
å¯¹äºç°åœ¨é¢å¯¹çš„é—®é¢˜æœ¬è´¨, å®é™…ä¸Šå°±æ˜¯å¯¹ä¸€ä¸ªé•¿å­—ç¬¦ä¸²çš„åŒ¹é…å…³é”®å­—çš„é—®é¢˜, å› æ­¤é™¤äº†ä½¿ç”¨å‰ç¼€æ ‘, è¿˜å¯ä»¥ä½¿ç”¨æ­£åˆ™åŒ¹é…çš„æ–¹å¼æ¥è§£å†³ã€‚
##  ä½¿ç”¨å‰ç¼€æ ‘ vs ä½¿ç”¨æ­£åˆ™åŒ¹é…çš„å¯¹æ¯”	
|   | ä½¿ç”¨å‰ç¼€æ ‘ Trie | ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ |
|---|---|---|
| æ€§èƒ½ | ğŸ”¥ æ›´é«˜æ•ˆï¼ˆå°¤å…¶æ˜¯å…³é”®è¯å¤šæ—¶ï¼‰ | â— éšå…³é”®è¯æ•°é‡å¢åŠ ï¼Œæ€§èƒ½ä¸‹é™ |
| åŒ¹é…æ–¹å¼ | ä¸€æ¬¡éå†å­—ç¬¦æµå³å¯è¯†åˆ«æ˜¯å¦å«æœ‰å…³é”®è¯ï¼ˆé€å­—ç¬¦æŸ¥å­—å…¸ï¼‰ | æ¯æ¬¡éƒ½éœ€é‡æ–°è§£é‡Š/ç¼–è¯‘æ­£åˆ™ï¼Œè¿›è¡Œæ¨¡å¼åŒ¹é… |
| ç»´æŠ¤æ€§ | å¢åˆ å…³é”®è¯ä»…ä¿®æ”¹å…³é”®è¯æ•°ç»„ | ä¿®æ”¹æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ˜“å‡ºé”™ |
| æ‰©å±•æ€§ | æ”¯æŒæ›´å¤æ‚çš„åŒ¹é…é€»è¾‘ï¼ˆæ¯”å¦‚è¯é¢‘ç»Ÿè®¡ã€è‡ªåŠ¨è¡¥å…¨ï¼‰ | åªèƒ½ç®€å•åŒ¹é…ï¼Œéš¾ä»¥æ‰©å±•é€»è¾‘ |
| å¯è¯»æ€§ | ä»£ç é€»è¾‘æ¸…æ™° | æ­£åˆ™è¯­æ³•å¤æ‚ï¼Œå¯è¯»æ€§å·® |
| é€‚åˆè§„æ¨¡ | å…³é”®è¯å¤šï¼ˆå‡ ååˆ°ä¸Šç™¾ï¼‰æ—¶æ•ˆæœæ˜¾è‘— | å…³é”®è¯å°‘æ—¶æ¯”è¾ƒæ–¹ä¾¿å¿«é€Ÿ |

ä»æ€§èƒ½è§’åº¦è€ƒè™‘ï¼Œå‰ç¼€æ ‘åœ¨å¤„ç†åœ°å€å…³é”®è¯çš„è¿‡æ»¤æ—¶æœ‰æ˜¾è‘—ä¼˜åŠ¿ï¼Œå°¤å…¶æ˜¯é¢å¯¹å¤§é‡æ•°æ®æ—¶ã€‚å‰ç¼€æ ‘çš„æŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ï¼Œå¹¶ä¸”æ²¡æœ‰å›æº¯é—®é¢˜ï¼Œå†…å­˜è®¿é—®é«˜æ•ˆï¼Œé€‚åˆç”¨äºå¤§è§„æ¨¡å­—ç¬¦ä¸²åŒ¹é…ã€‚è€Œæ­£åˆ™è¡¨è¾¾å¼åœ¨åŒ¹é…æ—¶å¯èƒ½ä¼šé‡åˆ°å›æº¯é—®é¢˜ï¼Œå¹¶ä¸”å¯¹äºå¤æ‚æ¨¡å¼çš„åŒ¹é…å¼€é”€è¾ƒå¤§ï¼Œå°¤å…¶åœ¨éœ€è¦é¢‘ç¹æ£€æŸ¥å¤šä¸ªå­—ç¬¦ä¸²æ—¶æ€§èƒ½è¾ƒå·®ã€‚å› æ­¤ï¼Œä½¿ç”¨å‰ç¼€æ ‘ä½œä¸ºè¿‡æ»¤å·¥å…·èƒ½æ˜¾è‘—æé«˜æ•ˆç‡ï¼Œé¿å…äº†æ­£åˆ™è¡¨è¾¾å¼å¯èƒ½å¸¦æ¥çš„æ€§èƒ½ç“¶é¢ˆã€‚
# å…·ä½“å®ç°
## æµç¨‹å›¾
```mermaid
graph TD
    A[è¾“å…¥åœ°å€å’Œé™åˆ¶ç±»å‹] --> B{è¾“å…¥æ˜¯å¦åˆæ³•?}
    B -->|æ˜¯| C{åŒ…å«åœ°å€å…³é”®è¯?}
    B -->|å¦| Z1[è¿”å›ç©ºå­—ç¬¦ä¸²]
    C -->|æ˜¯| D{é•¿åº¦ â‰¤ é™åˆ¶é•¿åº¦?}
    C -->|å¦| Z2[è¿”å›ç©ºå­—ç¬¦ä¸²]
    D -->|æ˜¯| E[ç›´æ¥è¿”å›åŸåœ°å€]
    D -->|å¦| F[ä½¿ç”¨å‰ç¼€æ ‘åˆ†å‰²åœ°å€]
    F --> G[é€æ­¥æ‹¼æ¥åˆ†å‰²éƒ¨åˆ†]
    G --> H{æ‹¼æ¥åé•¿åº¦ â‰¤ é™åˆ¶?}
    H -->|æ˜¯| I[æ›´æ–°æœ‰æ•ˆç»“æœ]
    H -->|å¦| J[æ£€æŸ¥æ˜¯å¦éœ€è¦æˆªæ–­]
    J --> K{å­˜åœ¨æœ‰æ•ˆå…³é”®è¯ç»“å°¾?}
    K -->|æ˜¯| L[è¿”å›æœ€è¿‘å…³é”®è¯æˆªæ–­]
    K -->|å¦| M[è¿”å›ç©ºå­—ç¬¦ä¸²]
    I --> N[æ‹¼æ¥å®Œæˆ?]
    N -->|æ˜¯| O[è¿”å›å®Œæ•´æ‹¼æ¥ç»“æœ]
    N -->|å¦| G
    O --> END[ç»“æŸ]
```

## ä»£ç 
```java
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * åŸºäºå‰ç¼€æ ‘çš„æ ¼å¼åŒ–åœ°å€å·¥å…·ç±»
 */
public class LocationFormatUtils {

    private static final TrieNode root = new TrieNode();

    // çœå¸‚åŒºå¿ç­‰å…³é”®è¯
    private static final String[] LOCATION_KEYWORDS = {
            "è‡ªæ²»åŒº", "çœ", "å¸‚", "åŒº", "å¿", "è‡ªæ²»å¿", "è¡—é“", "é•‡", "ä¹¡", "è·¯", "è¡—", "å··", "å·", "å°åŒº", "æ ‹", "å¹¢",
            "æ‘", "ç»„", "å•å…ƒ", "å¼„", "å±‚", "å®¤", "åœº", "å¤§å¦", "é“", "å±¯", "é‡Œ", "å›­", "åœˆ"
    };

    static {
        // é¢„æ„å»º Trie æ ‘
        for (String keyword : LOCATION_KEYWORDS) {
            insertIntoTrie(keyword);
        }
    }

    /**
     * è·å–æœ€åˆé€‚çš„æ ¼å¼åŒ–åœ°å€ï¼Œä½¿ç”¨æŒ‡å®šé™åˆ¶ç±»å‹
     */
    public static String getMostAccurateLocation(String location, LimitType type) {
        int maxLength = type.getLength();

        if (location == null || location.isEmpty()) {
            return "";
        }

        if (location.replaceAll("[^\\p{L}\\p{N}]", "").isEmpty()) {
            return "";
        }

        if (!containsLocationKeyword(location)) {
            return "";
        }

        if (location.length() <= maxLength) {
            return location;
        }

        List<String> partsList = splitByTrie(location);
        String[] parts = partsList.toArray(new String[0]);

        StringBuilder result = new StringBuilder();
        int currentLength = 0;
        String lastValid = "";

        for (String part : parts) {
            int partLength = part.length();
            if (currentLength + partLength <= maxLength) {
                result.append(part);
                currentLength += partLength;
                lastValid = result.toString();
            } else {
                break;
            }
        }

        return lastValid.isEmpty() ? truncateLocation(location, maxLength) : lastValid;
    }

    /**
     * ä½¿ç”¨å‰ç¼€æ ‘åˆ†å‰²åœ°å€å­—ç¬¦ä¸²
     */
    private static List<String> splitByTrie(String location) {
        List<Integer> splitPoints = new ArrayList<>();
        splitPoints.add(0);
        int currentIndex = 0;
        int length = location.length();
        while (currentIndex < length) {
            int maxLen = findLongestKeyword(location, currentIndex);
            if (maxLen > 0) {
                int splitPoint = currentIndex + maxLen;
                splitPoints.add(splitPoint);
                currentIndex = splitPoint;
            } else {
                currentIndex++;
            }
        }
        splitPoints.add(length); // æ·»åŠ ç»“æŸç‚¹

        List<String> parts = new ArrayList<>();
        for (int i = 1; i < splitPoints.size(); i++) {
            int start = splitPoints.get(i - 1);
            int end = splitPoints.get(i);
            if (start < end) {
                parts.add(location.substring(start, end));
            }
        }
        return parts;
    }

    /**
     * å¯»æ‰¾ä»æŒ‡å®šä½ç½®å¼€å§‹çš„æœ€é•¿å…³é”®è¯
     */
    private static int findLongestKeyword(String s, int start) {
        int maxLen = 0;
        TrieNode node = root;
        for (int i = start; i < s.length(); i++) {
            char c = s.charAt(i);
            if (node.children.containsKey(c)) {
                node = node.children.get(c);
                if (node.isEnd) {
                    maxLen = i - start + 1;
                }
            } else {
                break;
            }
        }
        return maxLen;
    }

    /**
     * åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ°å€å…³é”®è¯
     */
    private static boolean containsLocationKeyword(String location) {
        TrieNode node = root;
        for (char c : location.toCharArray()) {
            if (node.children.containsKey(c)) {
                node = node.children.get(c);
                if (node.isEnd) {
                    return true;
                }
            }
        }
        return false;
    }

    /**
     * æˆªæ–­åœ°å€è‡³æŒ‡å®šé•¿åº¦ï¼Œå¹¶ç¡®ä¿ä¸æˆªæ–­å…³é”®å­—
     */
    private static String truncateLocation(String location, int maxLength) {
        String truncated = location.substring(0, maxLength);
        int lastValidIndex = -1;
        TrieNode node = root;
        int currentLength = 0;

        for (int i = 0; i < truncated.length(); i++) {
            char c = truncated.charAt(i);
            if (node.children.containsKey(c)) {
                node = node.children.get(c);
                currentLength++;
                if (node.isEnd) {
                    lastValidIndex = i + 1;
                }
            } else {
                // é‡ç½®åˆ°æ ¹èŠ‚ç‚¹ï¼Œç»§ç»­å¯»æ‰¾å¯èƒ½çš„åŒ¹é…
                node = root;
                currentLength = 0;
            }
        }

        return (lastValidIndex != -1) ? truncated.substring(0, lastValidIndex) : "";
    }

    /**
     * åœ¨ Trie æ ‘ä¸­æ’å…¥å…³é”®è¯
     */
    private static void insertIntoTrie(String word) {
        TrieNode node = root;
        for (char c : word.toCharArray()) {
            node.children.putIfAbsent(c, new TrieNode());
            node = node.children.get(c);
        }
        node.isEnd = true;
    }

    /**
     * Trie ç»“æ„å®šä¹‰
     */
    static class TrieNode {
        Map<Character, TrieNode> children = new HashMap<>();
        boolean isEnd = false;
    }

    /**
     * åœ°å€é•¿åº¦é™åˆ¶ç±»å‹æšä¸¾
     */
    public enum LimitType {
        SMS(32, "SMS åœ°å€é•¿åº¦"),
        SUBSCRIBE_MSG(20, "å¾®ä¿¡å°ç¨‹åºè®¢é˜…æ¶ˆæ¯é•¿åº¦");

        private final int length;
        private final String desc;

        LimitType(int length, String desc) {
            this.length = length;
            this.desc = desc;
        }

        public int getLength() {
            return length;
        }

        public String getDesc() {
            return desc;
        }
    }

    public static void main(String[] args) {
        System.out.println(getMostAccurateLocation("åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬è¡—é“é˜œå®‰è¥¿è·¯8å·", LimitType.SMS));
        System.out.println(getMostAccurateLocation("åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬è¡—é“é˜œå®‰è¥¿è·¯8å·", LimitType.SUBSCRIBE_MSG));
        System.out.println(getMostAccurateLocation("æ— åœ°å€å…³é”®å­—æ–‡æœ¬æè¿°ä¿¡æ¯ä»…ä½œæµ‹è¯•ç”¨é€”", LimitType.SMS));
        System.out.println(getMostAccurateLocation("###ï¿¥%@ï¼@@#ï¿¥%â€¦â€¦&*", LimitType.SUBSCRIBE_MSG));
    }
}
```
## æµ‹è¯•
### æµ‹è¯•ç±»
```java
public class LocationFormatUtilsTest {

    @Test
    @DisplayName("æµ‹è¯•ç›´è¾–å¸‚åœ°å€")
    void testDirectControlledMunicipality() {
        assertEquals("åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬è¡—é“é˜œå®‰è¥¿è·¯8å·", LocationFormatUtils.getMostAccurateLocation("åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬è¡—é“é˜œå®‰è¥¿è·¯8å·", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("ä¸Šæµ·å¸‚é»„æµ¦åŒºå—äº¬ä¸œè·¯299å¼„1å·", LocationFormatUtils.getMostAccurateLocation("ä¸Šæµ·å¸‚é»„æµ¦åŒºå—äº¬ä¸œè·¯299å¼„1å·", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("é‡åº†å¸‚æ¸ä¸­åŒºè§£æ”¾ç¢‘å…«ä¸€è·¯238å·", LocationFormatUtils.getMostAccurateLocation("é‡åº†å¸‚æ¸ä¸­åŒºè§£æ”¾ç¢‘å…«ä¸€è·¯238å·", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("å¤©æ´¥å¸‚å—å¼€åŒºå«æ´¥å—è·¯66å·", LocationFormatUtils.getMostAccurateLocation("å¤©æ´¥å¸‚å—å¼€åŒºå«æ´¥å—è·¯66å·", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
    }

    @Test
    @DisplayName("æµ‹è¯•çŸ­åœ°å€ï¼ˆç›´æ¥è¿”å›ï¼‰")
    void testShortAddress() {
        assertEquals("æ·±åœ³å¸‚å—å±±åŒº", LocationFormatUtils.getMostAccurateLocation("æ·±åœ³å¸‚å—å±±åŒº", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("æˆéƒ½å¸‚æ­¦ä¾¯åŒº", LocationFormatUtils.getMostAccurateLocation("æˆéƒ½å¸‚æ­¦ä¾¯åŒº", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("æ­å·å¸‚è¥¿æ¹–åŒº", LocationFormatUtils.getMostAccurateLocation("æ­å·å¸‚è¥¿æ¹–åŒº", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
    }

    @Test
    @DisplayName("æµ‹è¯•ç›´è¾–å¸‚è¶…é•¿åœ°å€ï¼ˆæˆªæ–­ï¼‰")
    void testDirectControlledMunicipalityLong() {
        assertEquals("åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬è¡—é“é˜œå®‰è¥¿è·¯8å·å›½é™…å¤§å¦", LocationFormatUtils.getMostAccurateLocation("åŒ—äº¬å¸‚æœé˜³åŒºæœ›äº¬è¡—é“é˜œå®‰è¥¿è·¯8å·å›½é™…å¤§å¦Aåº§12æ¥¼1208å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("ä¸Šæµ·å¸‚é»„æµ¦åŒºå—äº¬ä¸œè·¯299å¼„1å·æ±‡é‡‘å¤§å¦", LocationFormatUtils.getMostAccurateLocation("ä¸Šæµ·å¸‚é»„æµ¦åŒºå—äº¬ä¸œè·¯299å¼„1å·æ±‡é‡‘å¤§å¦27å±‚2701å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("é‡åº†å¸‚æ¸ä¸­åŒºè§£æ”¾ç¢‘å…«ä¸€è·¯238å·", LocationFormatUtils.getMostAccurateLocation("é‡åº†å¸‚æ¸ä¸­åŒºè§£æ”¾ç¢‘å…«ä¸€è·¯238å·å¤§éƒ½ä¼šå¹¿åœºå†™å­—æ¥¼Aæ ‹2208å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("å¤©æ´¥å¸‚å—å¼€åŒºå«æ´¥å—è·¯66å·å—å¼€å¤§å­¦ç§‘æŠ€å›­", LocationFormatUtils.getMostAccurateLocation("å¤©æ´¥å¸‚å—å¼€åŒºå«æ´¥å—è·¯66å·å—å¼€å¤§å­¦ç§‘æŠ€å›­åˆ›æ–°å¤§å¦5å±‚501å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
    }

    @Test
    @DisplayName("æµ‹è¯•è‡ªæ²»åŒºè¶…é•¿åœ°å€ï¼ˆæˆªæ–­ï¼‰")
    void testAutonomousRegionLong() {
        assertEquals("å¹¿è¥¿å£®æ—è‡ªæ²»åŒºå—å®å¸‚é’ç§€åŒºæ°‘æ—å¤§é“", LocationFormatUtils.getMostAccurateLocation("å¹¿è¥¿å£®æ—è‡ªæ²»åŒºå—å®å¸‚é’ç§€åŒºæ°‘æ—å¤§é“166å·èˆªæ´‹å›½é™…Båº§30æ¥¼3006å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("è¥¿è—è‡ªæ²»åŒºæ‹‰è¨å¸‚åŸå…³åŒºæ±Ÿè‹ä¸œè·¯36å·", LocationFormatUtils.getMostAccurateLocation("è¥¿è—è‡ªæ²»åŒºæ‹‰è¨å¸‚åŸå…³åŒºæ±Ÿè‹ä¸œè·¯36å·è—åŒ»å­¦é™¢æ•™å­¦æ¥¼Aåº§302å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒºä¹Œé²æœ¨é½å¸‚å¤©å±±åŒºäººæ°‘è·¯", LocationFormatUtils.getMostAccurateLocation("æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒºä¹Œé²æœ¨é½å¸‚å¤©å±±åŒºäººæ°‘è·¯88å·å›½é™…å•†è´¸ä¸­å¿ƒ7å±‚703å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("å†…è’™å¤è‡ªæ²»åŒºå‘¼å’Œæµ©ç‰¹å¸‚èµ›ç½•åŒºæ–°åä¸œè¡—", LocationFormatUtils.getMostAccurateLocation("å†…è’™å¤è‡ªæ²»åŒºå‘¼å’Œæµ©ç‰¹å¸‚èµ›ç½•åŒºæ–°åä¸œè¡—89å·ä¸–è´¸å¹¿åœº5æ ‹21æ¥¼2102å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("å®å¤å›æ—è‡ªæ²»åŒºé“¶å·å¸‚å…´åº†åŒºè§£æ”¾è¥¿è¡—29å·", LocationFormatUtils.getMostAccurateLocation("å®å¤å›æ—è‡ªæ²»åŒºé“¶å·å¸‚å…´åº†åŒºè§£æ”¾è¥¿è¡—29å·é“¶å·å›½é™…å¤§å¦22æ¥¼2201å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
    }

    @Test
    @DisplayName("æµ‹è¯•ç‰¹åˆ«è¡Œæ”¿åŒºè¶…é•¿åœ°å€ï¼ˆæˆªæ–­ï¼‰")
    void testSpecialAdministrativeRegionLong() {
        assertEquals("é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºä¸­è¥¿åŒºä¸­ç¯çš‡åå¤§é“", LocationFormatUtils.getMostAccurateLocation("é¦™æ¸¯ç‰¹åˆ«è¡Œæ”¿åŒºä¸­è¥¿åŒºä¸­ç¯çš‡åå¤§é“ä¸­101å·å›½é™…é‡‘èä¸­å¿ƒäºŒæœŸ56å±‚5608å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒºèŠ±åœ°ç›å ‚åŒºå‹è°Šå¤§é©¬è·¯", LocationFormatUtils.getMostAccurateLocation("æ¾³é—¨ç‰¹åˆ«è¡Œæ”¿åŒºèŠ±åœ°ç›å ‚åŒºå‹è°Šå¤§é©¬è·¯399å·å—æ¹¾å¹¿åœº3æ¥¼301å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
    }

    @Test
    @DisplayName("æµ‹è¯•ä¸€èˆ¬è¶…é•¿åœ°å€ï¼ˆæˆªæ–­ï¼‰")
    void testLongGeneralAddress() {
        assertEquals("æµ™æ±Ÿçœæ­å·å¸‚è¥¿æ¹–åŒºæ–‡äºŒè¥¿è·¯åæ˜Ÿæ—¶ä»£å¹¿åœº", LocationFormatUtils.getMostAccurateLocation("æµ™æ±Ÿçœæ­å·å¸‚è¥¿æ¹–åŒºæ–‡äºŒè¥¿è·¯åæ˜Ÿæ—¶ä»£å¹¿åœºAåº§12æ¥¼1209å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("å¹¿ä¸œçœå¹¿å·å¸‚å¤©æ²³åŒºå¤©æ²³åŒ—è·¯233å·", LocationFormatUtils.getMostAccurateLocation("å¹¿ä¸œçœå¹¿å·å¸‚å¤©æ²³åŒºå¤©æ²³åŒ—è·¯233å·å¤©æ±‡å¤§å¦25æ¥¼2502å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
        assertEquals("å››å·çœæˆéƒ½å¸‚é”¦æ±ŸåŒºæ˜¥ç†™è·¯å¤ªå¤é‡Œå—é‡Œå•†åœˆ", LocationFormatUtils.getMostAccurateLocation("å››å·çœæˆéƒ½å¸‚é”¦æ±ŸåŒºæ˜¥ç†™è·¯å¤ªå¤é‡Œå—é‡Œå•†åœˆAæ ‹18å±‚1803å®¤", LocationFormatUtils.LimitType.SUBSCRIBE_MSG));
    }

    @Test
    @DisplayName("æµ‹è¯•ç‰¹æ®Šå­—ç¬¦ & å¼‚å¸¸è¾“å…¥")
    void testSpecialCases() {
        assertEquals("", LocationFormatUtils.getMostAccurateLocation("", LocationFormatUtils.LimitType.SUBSCRIBE_MSG)); // ç©ºå­—ç¬¦ä¸²
        assertEquals("", LocationFormatUtils.getMostAccurateLocation(null, LocationFormatUtils.LimitType.SUBSCRIBE_MSG)); // null
        assertEquals("", LocationFormatUtils.getMostAccurateLocation("12345678901234567890", LocationFormatUtils.LimitType.SUBSCRIBE_MSG)); // æ— å…³é”®è¯
        assertEquals("", LocationFormatUtils.getMostAccurateLocation("æ— åœ°å€å…³é”®å­—æ–‡æœ¬æè¿°ä¿¡æ¯ä»…ä½œæµ‹è¯•ç”¨é€”", LocationFormatUtils.LimitType.SUBSCRIBE_MSG)); // æ— åœ°å€å…³é”®å­—
        assertEquals("", LocationFormatUtils.getMostAccurateLocation("###ï¿¥%@ï¼@@#ï¿¥%â€¦â€¦&*", LocationFormatUtils.LimitType.SUBSCRIBE_MSG)); // ç‰¹æ®Šå­—ç¬¦
    }
}
```
### ç»“æœ
![æµ‹è¯•ç±»è¿è¡Œç»“æœ](https://blog-1318796820.cos.ap-shanghai.myqcloud.com/blog/%E5%9F%BA%E4%BA%8E%E5%89%8D%E7%BC%80%E6%A0%91%E7%9A%84%E5%9C%B0%E5%9D%80%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7%E7%B1%BB202504051800488.png)